# OpenECU Alliance Protocol Definition
# ECUMaster EMU CAN Broadcast Protocol
#
# ECUMaster ADU CAN Stream Protocol for EMU BLACK and EMU PRO ECUs.
# Documentation source: ECUMaster ADU CAN Stream application notes
#
# IMPORTANT NOTES:
# - Base CAN ID is configurable in ECU software (default 0x600)
# - This protocol documents the default ADU CAN stream configuration
# - Protocol operates at 1Mbit/s by default (configurable)
# - All values use little-endian byte order
# - Temperatures are transmitted in Celsius (signed)
# - Pressures are in kPa (absolute or gauge depending on sensor config)

openecualliance: "1.0"
type: protocol

id: ecumaster-emu-broadcast
name: "ECUMaster EMU CAN Broadcast Protocol"
version: "1.0.0"
vendor: ecumaster
description: |
  CAN broadcast protocol for ECUMaster EMU BLACK and EMU PRO ECUs.
  This protocol is the default ADU CAN stream used for communication with
  ECUMaster ADU displays, data loggers, and other CAN-enabled devices.

  The protocol uses 11-bit identifiers with configurable base address.
  Default base address is 0x600 with messages spanning 0x600-0x607.
  Each message contains 8 bytes of data in little-endian format.

  Temperature values are transmitted in degrees Celsius.
  Pressure values are in kPa (sensor configuration determines gauge vs absolute).
  Lambda values are transmitted as raw lambda (0.65-1.30 typical range).

website: "https://www.ecumaster.com"

branding:
  logo: ecumaster-logo.svg
  icon: ecumaster-icon.svg
  color_primary: "#FF6600"
  color_secondary: "#1A1A1A"

protocol:
  type: can
  baudrate: 1000000
  extended_id: false
  configurable_base_id: true
  default_base_id: 0x600

messages:
  # ============================================================================
  # FRAME 1 (Base ID + 0) - Core Engine Data
  # ============================================================================

  - id: 0x600
    name: "Engine Data 1"
    description: "RPM, TPS, IAT, MAP"
    length: 8
    interval_ms: 10
    transmitter: ECU
    signals:
      - name: "RPM"
        description: "Engine rotational speed"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: "rpm"
        min: 0
        max: 20000

      - name: "TPS"
        description: "Throttle position sensor"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "IAT"
        description: "Intake air temperature"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "C"
        min: -40
        max: 150
        comment: "y = x * 0.1 for Celsius"

      - name: "MAP"
        description: "Manifold absolute pressure"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: 0
        max: 400
        comment: "y = x * 0.1"

  # ============================================================================
  # FRAME 2 (Base ID + 1) - Injection and Ignition
  # ============================================================================

  - id: 0x601
    name: "Engine Data 2"
    description: "Injector pulse width, ignition angle, lambda, AFR"
    length: 8
    interval_ms: 10
    transmitter: ECU
    signals:
      - name: "Injector_PW"
        description: "Injector pulse width"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.003333
        offset: 0
        unit: "ms"
        min: 0
        max: 50
        comment: "y = x / 300 (x in 1/300ms units)"

      - name: "Ignition_Angle"
        description: "Ignition timing advance"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "deg"
        min: -20
        max: 60
        comment: "y = x * 0.1, positive = advance BTDC"

      - name: "Lambda"
        description: "Wideband lambda value"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "lambda"
        min: 0.5
        max: 1.5
        comment: "y = x * 0.001"

      - name: "AFR"
        description: "Air-fuel ratio (for gasoline, lambda * 14.7)"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.01
        offset: 0
        unit: "afr"
        min: 8
        max: 22
        comment: "y = x * 0.01"

  # ============================================================================
  # FRAME 3 (Base ID + 2) - Temperatures and Pressures
  # ============================================================================

  - id: 0x602
    name: "Engine Data 3"
    description: "Coolant temp, oil temp, fuel pressure, oil pressure"
    length: 8
    interval_ms: 20
    transmitter: ECU
    signals:
      - name: "CLT"
        description: "Coolant temperature"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "C"
        min: -40
        max: 150
        comment: "y = x * 0.1"

      - name: "Oil_Temp"
        description: "Engine oil temperature"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "C"
        min: -40
        max: 180
        comment: "y = x * 0.1"

      - name: "Fuel_Pressure"
        description: "Fuel rail pressure"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: 0
        max: 1000
        comment: "y = x * 0.1"

      - name: "Oil_Pressure"
        description: "Engine oil pressure"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: 0
        max: 1000
        comment: "y = x * 0.1"

  # ============================================================================
  # FRAME 4 (Base ID + 3) - Vehicle Data
  # ============================================================================

  - id: 0x603
    name: "Vehicle Data"
    description: "Vehicle speed, battery voltage, gear, flags"
    length: 8
    interval_ms: 20
    transmitter: ECU
    signals:
      - name: "Vehicle_Speed"
        description: "Vehicle ground speed"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "km/h"
        min: 0
        max: 400
        comment: "y = x * 0.1"

      - name: "Battery_Voltage"
        description: "System battery voltage"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.01
        offset: 0
        unit: "V"
        min: 0
        max: 20
        comment: "y = x * 0.01"

      - name: "Gear"
        description: "Current gear position"
        start_bit: 32
        length: 8
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: ""
        min: -1
        max: 8
        comment: "-1 = Reverse, 0 = Neutral, 1-8 = Forward gears"

      - name: "ECU_Flags"
        description: "ECU status flags"
        start_bit: 40
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "Bit field: bit0=CEL, bit1=FuelPump, bit2=Fan, bit3=RevLimiter"

      - name: "Barometric_Pressure"
        description: "Barometric pressure"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: 80
        max: 110
        comment: "y = x * 0.1"

  # ============================================================================
  # FRAME 5 (Base ID + 4) - Boost and Duty Cycles
  # ============================================================================

  - id: 0x604
    name: "Boost and Outputs"
    description: "Boost pressure, boost target, boost duty, injector duty"
    length: 8
    interval_ms: 20
    transmitter: ECU
    signals:
      - name: "Boost_Pressure"
        description: "Boost pressure (gauge)"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: -100
        max: 300
        comment: "y = x * 0.1 (gauge pressure, negative = vacuum)"

      - name: "Boost_Target"
        description: "Target boost pressure"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "kPa"
        min: -100
        max: 300
        comment: "y = x * 0.1"

      - name: "Boost_Duty"
        description: "Boost solenoid duty cycle"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "Injector_Duty"
        description: "Injector duty cycle"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

  # ============================================================================
  # FRAME 6 (Base ID + 5) - Knock and VVT
  # ============================================================================

  - id: 0x605
    name: "Knock and VVT"
    description: "Knock level, knock retard, VVT intake, VVT exhaust"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "Knock_Level"
        description: "Knock sensor signal level"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.01
        offset: 0
        unit: "V"
        min: 0
        max: 5
        comment: "y = x * 0.01"

      - name: "Knock_Retard"
        description: "Knock-induced timing retard"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "deg"
        min: 0
        max: 20
        comment: "y = x * 0.1"

      - name: "VVT_Intake_Position"
        description: "VVT intake cam position"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "deg"
        min: -50
        max: 50
        comment: "y = x * 0.1"

      - name: "VVT_Exhaust_Position"
        description: "VVT exhaust cam position"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "deg"
        min: -50
        max: 50
        comment: "y = x * 0.1"

  # ============================================================================
  # FRAME 7 (Base ID + 6) - Extended Lambda and EGT
  # ============================================================================

  - id: 0x606
    name: "Lambda and EGT"
    description: "Lambda 2, lambda target, EGT 1, EGT 2"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "Lambda_2"
        description: "Second wideband lambda sensor"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "lambda"
        min: 0.5
        max: 1.5
        comment: "y = x * 0.001"

      - name: "Lambda_Target"
        description: "Target lambda value"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "lambda"
        min: 0.5
        max: 1.5
        comment: "y = x * 0.001"

      - name: "EGT_1"
        description: "Exhaust gas temperature 1"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200
        comment: "Direct Celsius value"

      - name: "EGT_2"
        description: "Exhaust gas temperature 2"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200
        comment: "Direct Celsius value"

  # ============================================================================
  # FRAME 8 (Base ID + 7) - Fuel and DBW
  # ============================================================================

  - id: 0x607
    name: "Fuel and DBW"
    description: "Fuel consumption, fuel level, DBW position, DBW target"
    length: 8
    interval_ms: 100
    transmitter: ECU
    signals:
      - name: "Fuel_Consumption"
        description: "Instantaneous fuel consumption"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "L/100km"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "Fuel_Level"
        description: "Fuel tank level"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "DBW_Position"
        description: "Drive-by-wire throttle actual position"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "DBW_Target"
        description: "Drive-by-wire throttle target position"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

  # ============================================================================
  # EXTENDED FRAMES (Optional, Base ID + 8 through + 15)
  # These may be enabled in ECU configuration for additional data
  # ============================================================================

  - id: 0x608
    name: "Extended Data 1"
    description: "Additional EGTs 3-4, additional pressures"
    length: 8
    interval_ms: 100
    transmitter: ECU
    signals:
      - name: "EGT_3"
        description: "Exhaust gas temperature 3"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

      - name: "EGT_4"
        description: "Exhaust gas temperature 4"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

      - name: "Fuel_Temp"
        description: "Fuel temperature"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "C"
        min: -40
        max: 100
        comment: "y = x * 0.1"

      - name: "Gearbox_Oil_Temp"
        description: "Gearbox oil temperature"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "C"
        min: -40
        max: 180
        comment: "y = x * 0.1"

  - id: 0x609
    name: "Extended Data 2"
    description: "Dwell time, fuel correction, analog inputs"
    length: 8
    interval_ms: 100
    transmitter: ECU
    signals:
      - name: "Dwell"
        description: "Coil dwell time"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.01
        offset: 0
        unit: "ms"
        min: 0
        max: 10
        comment: "y = x * 0.01"

      - name: "Fuel_Correction"
        description: "Total fuel correction"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: "%"
        min: -50
        max: 50
        comment: "y = x * 0.1"

      - name: "Analog_Input_1"
        description: "Analog input 1 voltage"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "V"
        min: 0
        max: 5
        comment: "y = x * 0.001"

      - name: "Analog_Input_2"
        description: "Analog input 2 voltage"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "V"
        min: 0
        max: 5
        comment: "y = x * 0.001"

  - id: 0x60A
    name: "Extended Data 3"
    description: "DSG gearbox data"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "DSG_Gear"
        description: "DSG current gear"
        start_bit: 0
        length: 8
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: ""
        min: -1
        max: 7
        comment: "-1 = Reverse, 0 = Neutral"

      - name: "DSG_Next_Gear"
        description: "DSG next gear (during shift)"
        start_bit: 8
        length: 8
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: ""
        min: -1
        max: 7

      - name: "DSG_State"
        description: "DSG gearbox state"
        start_bit: 16
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "0=Idle, 1=Upshift, 2=Downshift, 3=Clutch"

      - name: "Gear_Selector_Position"
        description: "Gear selector position"
        start_bit: 24
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "0=P, 1=R, 2=N, 3=D, 4=S, 5=Manual"

      - name: "DSG_Torque_Request"
        description: "DSG requested engine torque"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "Nm"
        min: 0
        max: 1000
        comment: "y = x * 0.1"

      - name: "Gearbox_State_Timer"
        description: "Time in current gearbox state"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "s"
        min: 0
        max: 65
        comment: "y = x * 0.001"

  - id: 0x60B
    name: "Extended Data 4"
    description: "Torque estimation and reduction"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "Engine_Torque_Percent"
        description: "Engine torque as percentage of maximum"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "Requested_Torque"
        description: "Requested engine torque"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "Nm"
        min: 0
        max: 1000
        comment: "y = x * 0.1"

      - name: "Torque_Reduction"
        description: "Total torque reduction"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "DBW_Torque_Reduction"
        description: "Torque reduction via DBW"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

  - id: 0x60C
    name: "Extended Data 5"
    description: "Launch control and traction control"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "Launch_Control_Active"
        description: "Launch control active flag"
        start_bit: 0
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "0 = Off, 1 = Active"

      - name: "Launch_RPM_Limit"
        description: "Launch control RPM limit"
        start_bit: 8
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: "rpm"
        min: 0
        max: 15000

      - name: "Traction_Control_Active"
        description: "Traction control active flag"
        start_bit: 24
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "0 = Off, 1 = Active"

      - name: "Traction_Cut_Percent"
        description: "Traction control cut percentage"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "%"
        min: 0
        max: 100
        comment: "y = x * 0.1"

      - name: "Rev_Limiter_Active"
        description: "Rev limiter active flag"
        start_bit: 48
        length: 8
        byte_order: little_endian
        data_type: unsigned
        scale: 1.0
        offset: 0
        unit: ""
        comment: "0 = Off, 1 = Active"

  - id: 0x60D
    name: "Extended Data 6"
    description: "Wheel speeds"
    length: 8
    interval_ms: 50
    transmitter: ECU
    signals:
      - name: "Wheel_Speed_FL"
        description: "Front left wheel speed"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "km/h"
        min: 0
        max: 400
        comment: "y = x * 0.1"

      - name: "Wheel_Speed_FR"
        description: "Front right wheel speed"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "km/h"
        min: 0
        max: 400
        comment: "y = x * 0.1"

      - name: "Wheel_Speed_RL"
        description: "Rear left wheel speed"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "km/h"
        min: 0
        max: 400
        comment: "y = x * 0.1"

      - name: "Wheel_Speed_RR"
        description: "Rear right wheel speed"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.1
        offset: 0
        unit: "km/h"
        min: 0
        max: 400
        comment: "y = x * 0.1"

  - id: 0x60E
    name: "Extended Data 7"
    description: "EGTs 5-8"
    length: 8
    interval_ms: 100
    transmitter: ECU
    signals:
      - name: "EGT_5"
        description: "Exhaust gas temperature 5"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

      - name: "EGT_6"
        description: "Exhaust gas temperature 6"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

      - name: "EGT_7"
        description: "Exhaust gas temperature 7"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

      - name: "EGT_8"
        description: "Exhaust gas temperature 8"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 1.0
        offset: 0
        unit: "C"
        min: 0
        max: 1200

  - id: 0x60F
    name: "Extended Data 8"
    description: "Analog inputs and user channels"
    length: 8
    interval_ms: 100
    transmitter: ECU
    signals:
      - name: "Analog_Input_3"
        description: "Analog input 3 voltage"
        start_bit: 0
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "V"
        min: 0
        max: 5
        comment: "y = x * 0.001"

      - name: "Analog_Input_4"
        description: "Analog input 4 voltage"
        start_bit: 16
        length: 16
        byte_order: little_endian
        data_type: unsigned
        scale: 0.001
        offset: 0
        unit: "V"
        min: 0
        max: 5
        comment: "y = x * 0.001"

      - name: "User_Channel_1"
        description: "User-defined channel 1"
        start_bit: 32
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: ""
        comment: "User-configurable scaling"

      - name: "User_Channel_2"
        description: "User-defined channel 2"
        start_bit: 48
        length: 16
        byte_order: little_endian
        data_type: signed
        scale: 0.1
        offset: 0
        unit: ""
        comment: "User-configurable scaling"

# Enumerations for special values
enums:
  - name: "GearPosition"
    description: "Gear position values"
    values:
      "-1": "Reverse"
      "0": "Neutral"
      "1": "1st Gear"
      "2": "2nd Gear"
      "3": "3rd Gear"
      "4": "4th Gear"
      "5": "5th Gear"
      "6": "6th Gear"
      "7": "7th Gear"
      "8": "8th Gear"

  - name: "DSGState"
    description: "DSG gearbox state values"
    values:
      "0": "Idle"
      "1": "Upshift"
      "2": "Downshift"
      "3": "Clutch Operation"

  - name: "GearSelectorPosition"
    description: "Gear selector position values"
    values:
      "0": "Park"
      "1": "Reverse"
      "2": "Neutral"
      "3": "Drive"
      "4": "Sport"
      "5": "Manual"

  - name: "ECUFlags"
    description: "ECU status flag bits"
    values:
      "bit0": "Check Engine Light"
      "bit1": "Fuel Pump Active"
      "bit2": "Cooling Fan Active"
      "bit3": "Rev Limiter Active"
      "bit4": "Launch Control Armed"
      "bit5": "Traction Control Active"
      "bit6": "Boost Cut Active"
      "bit7": "Reserved"

metadata:
  author: "OpenECU Alliance"
  license: "MIT"
  source_url: "https://www.ecumaster.com/downloads/"
  tested_with:
    - "ECUMaster EMU BLACK"
    - "ECUMaster EMU PRO"
    - "ECUMaster EMU CLASSIC"
    - "ECUMaster ADU5/ADU7 Dash"
  compatible_tools:
    - "ECUMaster ADU Dash"
    - "CANalyzer"
    - "PCAN-View"
    - "SavvyCAN"
    - "BusMaster"
    - "RaceChrono"
    - "AiM data loggers"
  known_issues:
    - "Base CAN ID is configurable (default 0x600)"
    - "Extended frames (0x608-0x60F) require explicit ECU configuration"
    - "Some channels may not be populated if features are not enabled"
    - "DSG support requires specific EMU BLACK configuration"
  changelog:
    - version: "1.0.0"
      date: "2026-01-07"
      changes:
        - "Initial release based on ECUMaster ADU CAN Stream protocol"
        - "Core frames 0x600-0x607 for primary engine data"
        - "Extended frames 0x608-0x60F for additional sensors"
        - "DSG gearbox control integration"
        - "Torque estimation and management signals"
        - "Launch and traction control status"
        - "Wheel speed inputs"
        - "Up to 8 EGT sensors"

# ECUMaster-specific notes
x_ecumaster:
  configurable_parameters:
    base_can_id:
      default: "0x600"
      range: "0x000-0x7FF"
      description: "Base CAN ID for all messages (offsets 0-15 added)"
    baudrate:
      default: "1000000"
      options: ["125000", "250000", "500000", "1000000"]
    update_rate:
      default: "100Hz"
      description: "Maximum update rate for primary frames"
  ecu_compatibility:
    emu_black: "Full support"
    emu_pro: "Full support"
    emu_classic: "Basic frames only (0x600-0x607)"
  protocol_notes: |
    ECUMaster ADU CAN Stream Protocol for EMU series ECUs.

    Important characteristics:
    - 11-bit CAN identifiers with configurable base address
    - Default 1 Mbit/second baud rate (configurable)
    - Little-endian data encoding throughout
    - Temperatures in Celsius (signed integers with scaling)
    - Pressures in kPa (may be gauge or absolute per sensor config)
    - Lambda as direct ratio (0.65-1.30 typical)

    The CAN stream is configured in EMU BLACK/PRO software under:
    Setup -> CAN Bus -> CAN Stream

    For ADU dash compatibility, use the default 0x600 base address
    and enable the frames you need.
